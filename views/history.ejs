<div class="history-container">
    <h2 style="margin-bottom: 2rem;">Your Consultation History</h2>

    <% if (chats.length===0) { %>
        <div
            style="text-align: center; padding: 3rem; background: white; border-radius: 1rem; color: var(--text-muted); box-shadow: var(--shadow-sm);">
            <p>No history found. Start a new consultation!</p>
            <a href="/"
                style="display: inline-block; margin-top: 1rem; color: var(--primary); text-decoration: none; font-weight: 500;">Start
                Chat &rarr;</a>
        </div>
        <% } %>

            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <% chats.forEach(chat=> { %>
                    <div
                        style="background: white; padding: 1.5rem; border-radius: 1rem; box-shadow: var(--shadow-sm); transition: transform 0.2s; border: 1px solid var(--border);">
                        <div
                            style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                            <h3 style="font-size: 1.1rem; color: var(--text-main);">
                                <%= chat.title %>
                            </h3>
                            <span style="font-size: 0.85rem; color: var(--text-muted);">
                                <%= new Date(chat.createdAt).toLocaleDateString() %>
                            </span>
                        </div>
                        <!-- Show preview of last message or summary if we had one -->
                        <p
                            style="color: var(--text-muted); font-size: 0.95rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-clamp: 2;">
                            <%= chat.messages.length> 0 ? chat.messages[chat.messages.length - 1].content.substring(0,
                                150) + '...' : 'No messages' %>
                        </p>
                    </div>
                    <% }) %>
            </div>
</div>